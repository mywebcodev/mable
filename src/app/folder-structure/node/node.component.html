<ul>
  <li [class.root]="node.children?.length">
    <ng-container *ngTemplateOutlet="nodeTemplate;context:{nodeValue: node}"></ng-container>
  </li>
  <li *ngFor="let child of node.children">
    <ng-container [ngSwitch]="child.type">
      <ng-container *ngSwitchCase="nodeType.Folder"><app-node [node]="child"></app-node></ng-container>
      <ng-container *ngSwitchDefault>
        <ng-container *ngTemplateOutlet="nodeTemplate;context:{nodeValue: child}"></ng-container>
      </ng-container>
    </ng-container>
  </li>
  <li *ngIf="canShowControls(node)">
    <div class="btn-group">
      <button type="button" class="add-node-btn" (click)="onCreate(nodeType.Folder, node)">Folder</button>
      <button type="button" class="add-node-btn" (click)="onCreate(nodeType.File, node)">File</button>
    </div>
  </li>
</ul>

<ng-template #nodeTemplate let-nodeValue="nodeValue">
  <div class="card" ngClass="{{nodeValue.type}}">
    <div *ngIf="!showAddNoteControl; else addNoteTemplate" class="node-flex-container">
      <span class="node-name">{{nodeValue.name}}</span>
      <div class="node-btn-group">
        <img class="add-node-btn" src="../../../assets/images/folder-structure/add-circle.svg" (click)="onShowAddNoteControl()">
        <img class="add-node-btn" src="../../../assets/images/folder-structure/delete.svg" (click)="onDelete(nodeValue)">
      </div>
    </div>
  </div>
</ng-template>

<ng-template #addNoteTemplate>
  <app-add-note></app-add-note>
</ng-template>
